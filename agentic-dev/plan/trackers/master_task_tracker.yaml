# Embeddenator Master Task Tracker - Machine Optimized
# Generated: 2025-12-31
# Purpose: Agent-executable task tracking with dependencies

meta:
  project: embeddenator
  version: 0.2.0
  generated: "2025-12-31T14:56:00Z"
  root_path: /home/kang/Documents/projects/embeddenator

priorities:
  P0: critical_blocking
  P1: high_release
  P2: medium_planned
  P3: low_nice_to_have

phases:
  - id: phase_1
    name: core_vsa_extensions
    priority: P0
    tasks:
      - id: TASK-VSA-001
        title: Implement VSAConfig adaptive sparsity
        status: completed
        agent: RustEngineer
        deps: []
        files: [src/vsa.rs]
        acceptance:
          - VSAConfig struct with dimensionality/sparsity
          - high_precision/balanced/fast presets
          - Unit tests for all presets
        estimate_hours: 4
        
      - id: TASK-VSA-002
        title: Add permutation tagging for order encoding
        status: completed
        agent: VSAExpert
        deps: [TASK-VSA-001]
        files: [src/vsa.rs]
        acceptance:
          - Cyclic shift permutation function
          - Inverse permutation for decoding
          - Tests for sequence encoding
        estimate_hours: 6
        
      - id: TASK-VSA-003
        title: Implement context-dependent thinning
        status: completed
        agent: VSAExpert
        deps: [TASK-VSA-001]
        files: [src/vsa.rs]
        acceptance:
          - CDT function preserving sparsity during bundle/bind
          - Configurable thinning threshold
          - Property tests for sparsity invariants
        estimate_hours: 8

      - id: TASK-INTEROP-001
        title: Add kernelâ†”VSA interop layer (non-FUSE)
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/kernel_interop.rs, src/lib.rs, docs/KERNEL_VSA_INTEROP.md]
        acceptance:
          - Provide minimal traits bridging kernel/runtime to VSA ops
          - Avoid FUSE feature entanglement (works in default non-fuse builds)
          - Include adapter-friendly retrieval/rerank seam for Engram codebook
          - Tests compile in default and bt-phase-1 builds
        estimate_hours: 8
        completed_at: "2026-01-01"

  - id: phase_2
    name: resonator_networks
    priority: P0
    tasks:
      - id: TASK-RES-001
        title: Implement base resonator network structure
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001, TASK-VSA-003]
        files: [src/resonator.rs]
        acceptance:
          - Resonator struct with codebook projection
          - Iterative refinement loop
          - Convergence delta tracking
        estimate_hours: 12
        
      - id: TASK-RES-002
        title: Add ternary sign thresholding
        status: completed
        agent: VSAExpert
        deps: [TASK-RES-001]
        files: [src/resonator.rs]
        acceptance:
          - Sign function for ternary projection
          - Sparsity preservation post-threshold
        estimate_hours: 4
        
      - id: TASK-RES-003
        title: Integrate resonator with EmbrFS extraction
        status: completed
        agent: RustEngineer
        deps: [TASK-RES-001, TASK-RES-002]
        files: [src/embrfs.rs, src/resonator.rs]
        acceptance:
          - Optional resonator disentangle during unbind
          - 100% reconstruction at 20+ hierarchy levels
          - Integration tests
        estimate_hours: 8

  - id: phase_3
    name: hierarchical_multi_level_engrams
    priority: P1
    tasks:
      - id: TASK-HIE-001
        title: Design nested manifest format
        status: completed
        agent: RustEngineer
        deps: []
        files: [src/embrfs.rs, docs/HIERARCHICAL_FORMAT.md]
        acceptance:
          - JSON schema for nested sub-engram refs
          - Backward compatible with flat format
        estimate_hours: 4
        
      - id: TASK-HIE-002
        title: Implement level-0 leaf encoding
        status: pending
        agent: RustEngineer
        deps: [TASK-HIE-001]
        files: [src/embrfs.rs]
        notes:
          - "Tracker drift: current implementation builds hierarchical sub-engrams inside bundle_hierarchically(), and sub-engram bincode serialization is implemented (save_sub_engrams_dir + DirectorySubEngramStore)."
          - "Open question: explicit <=1000 chunks-per-directory splitting is not enforced as a distinct step; consider re-scoping this task into an explicit leaf-splitting pass if still required."
        acceptance:
          - Small bundles <=1000 chunks per directory
          - Sub-engram serialization
        estimate_hours: 8
        
      - id: TASK-HIE-003
        title: Implement multi-level bundling
        status: completed
        agent: RustEngineer
        deps: [TASK-HIE-002, TASK-VSA-002]
        files: [src/embrfs.rs]
        acceptance:
          - Path role binding with permutation
          - Level-by-level bundle limiting
          - TB+ synthetic test success
        estimate_hours: 12
        
      - id: TASK-HIE-004
        title: Implement hierarchical extraction
        status: completed
        agent: RustEngineer
        deps: [TASK-HIE-003, TASK-RES-003]
        files: [src/embrfs.rs]
        acceptance:
          - Manifest-guided level traversal
          - 100% bit-perfect reconstruction
          - E2E tests
        estimate_hours: 10

      - id: TASK-HIE-005
        title: Add CLI hierarchical artifact builder
        status: completed
        agent: RustEngineer
        deps: [TASK-HIE-003]
        files: [src/cli.rs, src/embrfs.rs, src/lib.rs, tests/integration_cli.rs]
        acceptance:
          - CLI command produces hierarchical manifest JSON + sub-engrams directory
          - Artifacts compatible with store-backed selective unfolding query
          - Integration test validates artifact generation and query does not error
        estimate_hours: 4
        completed_at: "2026-01-01"

      - id: TASK-PLACEHOLDER-001
        title: Fix resonator recovery implementation
        status: pending
        agent: RustEngineer
        deps: [TASK-RES-003]
        files: [src/embrfs.rs, src/resonator.rs]
        notes:
          - "Resonator-based best-effort recovery exists in EmbrFS extraction for missing chunks, but this placeholder implies a more principled recovery path + coverage for missing-chunk regimes."
        acceptance:
          - Actual chunk recovery from resonator projection
          - Fallback to alternative recovery methods
          - Integration tests with missing chunks
        estimate_hours: 8
        
      - id: TASK-PLACEHOLDER-002
        title: Fix hierarchical extraction to use manifest structure
        status: pending
        agent: RustEngineer
        deps: [TASK-HIE-004]
        files: [src/embrfs.rs]
        notes:
          - "Manifest-guided traversal exists, but this placeholder suggests auditing inverse permutation usage + ensuring sub-engram IDs/children drive traversal (not just prefix grouping)."
        acceptance:
          - True manifest-guided traversal
          - Proper sub-engram utilization
          - Inverse permutation decoding
        estimate_hours: 10
        
      - id: TASK-PLACEHOLDER-003
        title: Implement SparseVec to bytes conversion
        status: pending
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/vsa.rs]
        acceptance:
          - Lossless VSA-based data encoding/decoding
          - Alternative to current codebook approach
          - Performance benchmarks vs current method
        estimate_hours: 12

  - id: phase_4
    name: performance_optimizations
    priority: P2
    tasks:
      - id: TASK-PERF-001
        title: Add rayon parallelism to ingest/extract
        status: completed
        agent: RustEngineer
        deps: [TASK-HIE-004]
        files: [src/embrfs.rs, Cargo.toml]
        acceptance:
          - Parallel chunk encoding
          - Thread-safe vector handling
          - Benchmark improvements
        estimate_hours: 6
        completed_at: "2026-01-01"

      - id: TASK-PERF-003
        title: Optimize reversible VSA encode/decode hot path
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/vsa.rs]
        acceptance:
          - Remove per-block permutation allocations in encode
          - Bound decode work by expected output size
          - Avoid linear membership scans in decode
          - All tests passing
        estimate_hours: 4
        completed_at: "2026-01-01"

      - id: TASK-PERF-004
        title: Replace HashSet-heavy VSA ops with merge-based math
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/vsa.rs]
        acceptance:
          - bundle/bind/cosine avoid HashSet allocations
          - operations remain deterministic and indices remain sorted
          - all tests passing
        estimate_hours: 4
        completed_at: "2026-01-01"

  - id: phase_10
    name: semantic_retrieval
    priority: P1
    tasks:
      - id: TASK-RET-001
        title: Implement inverted index for SparseVec semantic search
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/retrieval.rs, src/lib.rs, tests/retrieval_index.rs]
        acceptance:
          - Build index from (id, SparseVec)
          - Query top-k candidates with dot-score accumulation
          - Unit/integration test validates self-match top hit
        estimate_hours: 6
        completed_at: "2026-01-01"

      - id: TASK-RET-002
        title: Add rerank stage (cosine) + EmbrFS integration
        status: completed
        agent: RustEngineer
        deps: [TASK-RET-001]
        files: [src/retrieval.rs, src/embrfs.rs, src/cli.rs]
        acceptance:
          - Index Engram.codebook for query
          - Rerank candidates with exact cosine
          - CLI command can query engrams efficiently
        estimate_hours: 10
        completed_at: "2026-01-01"

      - id: TASK-RET-003
        title: Implement recursive selective unfolding over hierarchical engrams
        status: completed
        agent: RustEngineer
        deps: [TASK-RET-002, TASK-HIE-004]
        files: [src/embrfs.rs, src/lib.rs, docs/RECURSIVE_UNFOLDING.md, tests/hierarchical_unfolding.rs]
        notes:
          - Preliminary plan (2026-01-01): implement a beam-limited traversal over hierarchical sub-engrams.
          - Implementation (2026-01-01): added `query_hierarchical_codebook` + `HierarchicalQueryBounds` + deterministic beam traversal.
          - Added `SubEngramStore` seam and `query_hierarchical_codebook_with_store` to enable on-demand sub-engram loading.
          - Added `SubEngram.chunk_ids` so per-node search can index only the node-local subset of the global codebook.
          - Implemented bounded LRU cache for per-sub-engram inverted indices (caps memory).
          - Implemented bounded LRU cache for loaded sub-engrams (caps memory).
          - Tests added for bounds (beam/max_depth/max_expansions), determinism, and child descent.
          - Add on-demand sub-engram loader + LRU eviction for both sub-engrams and per-sub-engram inverted indices.
          - Define a stable query API that returns (sub_engram_id, chunk_id, cosine) with recursion bounds.
          - Tests: bounded recursion, deterministic results on fixture hierarchy, and no unbounded memory growth.
        acceptance:
          - Beam-limited descent over sub-engrams
          - On-demand loading and index eviction policy
          - Tests for bounded recursion and correctness
        estimate_hours: 16
        started_at: "2026-01-01"
        completed_at: "2026-01-01"

      - id: TASK-RET-004
        title: Differential update for hierarchical engrams
        status: pending
        agent: RustEngineer
        deps: [TASK-RET-003]
        files: [src/embrfs.rs, src/correction.rs]
        acceptance:
          - Detect changed chunks
          - Recompute only affected leaf vectors
          - Recompute bundles on affected paths only
          - Validate reconstruction for modified files
        estimate_hours: 20

  - id: phase_11
    name: balanced_ternary_refactor
    priority: P1
    tasks:
      - id: TASK-BT-001
        title: Add benches and invariants for ternary refactor
        status: completed
        agent: RustEngineer
        deps: [TASK-TERNARY-001]
        files: [benches/vsa_ops.rs, benches/retrieval.rs, tests/ternary_refactor_invariants.rs, Cargo.toml, docs/THROUGHPUT.md]
        acceptance:
          - Bench coverage for bundle/bind/cosine and encode/decode
          - Invariant tests comparing legacy vs new paths on randomized inputs
          - Document perf deltas in docs/THROUGHPUT.md
        estimate_hours: 12
        completed_at: "2026-01-01"

      - id: TASK-BT-002
        title: Introduce ternary-native vector representation
        status: completed
        agent: RustEngineer
        deps: [TASK-BT-001]
        files: [src/ternary_vec.rs, src/ternary.rs, tests/packed_trit_vec.rs, src/lib.rs]
        acceptance:
          - Packed ternary vector type suitable for fast dot/bind/bundle
          - Adapter to/from SparseVec for interop
          - Unit tests for round-trips and correctness
        estimate_hours: 16
        completed_at: "2026-01-01"
        notes:
          - "Tracker drift: implementation lives in src/ternary_vec.rs as PackedTritVec; tests in tests/packed_trit_vec.rs; re-exported via src/lib.rs."

      - id: TASK-BT-003
        title: Add ternary-native fast paths for VSA ops
        status: completed
        agent: RustEngineer
        deps: [TASK-BT-002]
        files: [src/vsa.rs]
        acceptance:
          - bundle/bind/cosine use packed ternary paths where beneficial
          - No regression in correctness; deterministic results
          - Bench speedup demonstrated
        estimate_hours: 16
        completed_at: "2026-01-01"
        notes:
          - "Implemented word-wise PackedTritVec dot/bind/bundle and bt-phase-2 gated SparseVec fast paths (bundle/bind/cosine)."
          - "Validation: cargo test and cargo test --features bt-phase-2 passed."
          - "Bench (2026-01-01): cargo bench --bench vsa_ops and --features bt-phase-2 show no improvement in existing sparse-from_data benches (packed path typically not taken due to low nnz); some small noise-level deltas and a minor regression in cosine_chain_mix were observed."
          - "Follow-up: add dense-vector benchmarks and/or tune the fast-path threshold so BT-003 benefits are measurable where expected."

      - id: TASK-VSA-004
        title: Add dual-mode + hybrid bundling APIs
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/vsa.rs, tests/unit_tests.rs, benches/vsa_ops.rs]
        acceptance:
          - Preserve existing SparseVec::bundle semantics (conflict-cancel; non-associative)
          - Add an associative multiway bundle (sum contributions then threshold)
          - Add a hybrid selector that chooses pairwise vs associative based on density
          - Unit tests cover associativity counterexample + hybrid branch selection
          - cargo test passes
        estimate_hours: 6
        completed_at: "2026-01-01"
        notes:
          - "Added SparseVec::bundle_sum_many and SparseVec::bundle_hybrid_many; extended vsa_ops benches with bundle_modes group."

      - id: TASK-PERF-005
        title: Tune bundle thresholds using bundle_modes benches
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-004, TASK-BT-003]
        files: [src/vsa.rs, benches/vsa_ops.rs, docs/THROUGHPUT.md]
        acceptance:
          - Record baseline vs bt-phase-2 deltas for bundle_modes (sparse + dense)
          - Tune hybrid and packed thresholds to avoid regressions and capture dense wins
          - Document the tuning rationale and any trade-offs
        estimate_hours: 6
        completed_at: "2026-01-01"
        notes:
          - "Added mid-density bundle_modes probes around the packed threshold; documented default vs bt-phase-2 baselines in docs/THROUGHPUT.md."
          - "Hybrid remains conservative (collision-budget based) and selects sum-many in dense multiway regimes; pairwise dense benefits substantially from bt-phase-2 packed fast paths."
          - "Adjusted bt-phase-2 packed bind gating to require both operands individually dense, reducing sparse-workload overhead under bt-phase-2."

      - id: TASK-BT-006
        title: Reuse packed buffers to reduce conversion overhead
        status: completed
        agent: RustEngineer
        deps: [TASK-BT-003]
        files: [src/ternary_vec.rs, src/vsa.rs, docs/THROUGHPUT.md]
        acceptance:
          - Packed conversions avoid per-call allocations in bt-phase-2 hot paths
          - Deterministic and bit-exact behavior preserved
          - cargo test passes with and without bt-phase-2
          - Bench shows dense packed-path improvements or remains within noise
        estimate_hours: 6
        completed_at: "2026-01-01"
        notes:
          - "Added PackedTritVec::fill_from_sparsevec + *_into ops and thread-local scratch reuse for bt-phase-2 bundle/bind/cosine fast paths."
          - "Validation: cargo test and cargo test --features bt-phase-2 passed."
          - "Bench (2026-01-01): cargo bench --features bt-phase-2 --bench vsa_ops shows improved times for dense pairwise bundle modes vs earlier bt-phase-2 baselines; run-to-run variance remains for sub-100ns benches."

      - id: TASK-PERF-006
        title: Optimize SparseVec::bind for sparse regimes
        status: completed
        agent: RustEngineer
        deps: [TASK-PERF-004]
        files: [src/vsa.rs, benches/vsa_ops.rs, tests/unit_tests.rs]
        acceptance:
          - Replace binary_search-heavy bind inner loops with merge-based math on sorted indices
          - No correctness regressions; indices remain sorted
          - Bench shows improvement in sparsevec_ops/bind and bind_chain_8
        estimate_hours: 6
        completed_at: "2026-01-01"
        notes:
          - "Replaced SparseVec::bind sparse path with a single merge-join over signed supports, eliminating per-index binary_search calls and preserving sorted outputs without post-sort."

      - id: TASK-PERF-007
        title: Stabilize and extend packed-path benchmarks
        status: completed
        agent: Tester
        deps: [TASK-BT-006]
        files: [benches/vsa_ops.rs, docs/THROUGHPUT.md]
        acceptance:
          - Add explicit packed-path-only benches for bundle/bind/cosine (dense and mid-density)
          - Ensure bench inputs deterministically trigger the packed gate
          - Update THROUGHPUT with before/after deltas anchored to absolute times
        estimate_hours: 6
        completed_at: "2026-01-01"
        notes:
          - "Added packed_path/* criterion benchmarks sized to deterministically trigger bt-phase-2 packed gates for bundle/bind/cosine."

      - id: TASK-BT-007
        title: Reduce bt-phase-2 TLS scratch overhead (micro-optimizations)
        status: pending
        agent: RustEngineer
        deps: [TASK-BT-006, TASK-PERF-007]
        files: [src/vsa.rs, src/ternary_vec.rs, benches/vsa_ops.rs]
        acceptance:
          - Packed-path benches show no regressions vs pre-change baselines (bundle/bind/cosine)
          - Keep exactness and determinism; no unsafe code unless strictly justified
          - Document any measured wins in docs/THROUGHPUT.md
        estimate_hours: 6

      - id: TASK-BT-004
        title: Ternary-native retrieval signatures
        status: pending
        agent: RustEngineer
        deps: [TASK-RET-001, TASK-BT-002]
        files: [src/retrieval.rs]
        acceptance:
          - Add compact ternary signatures for bucketed candidate generation
          - Multi-probe support for near buckets
          - Tests validate recall on synthetic datasets
        estimate_hours: 20

      - id: TASK-BT-005
        title: Align EmbrFS for selective unfolding and differential updates
        status: pending
        agent: RustEngineer
        deps: [TASK-RET-003, TASK-RET-004, TASK-BT-003]
        files: [src/embrfs.rs, src/correction.rs, docs/RECURSIVE_UNFOLDING.md]
        acceptance:
          - On-demand sub-engram loading + index build
          - Eviction policy to bound RAM
          - Differential recomputation for modified shards
        estimate_hours: 24
        
      - id: TASK-PERF-002
        title: Implement SIMD cosine similarity
        status: pending
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/vsa.rs, Cargo.toml]
        acceptance:
          - Feature flag for SIMD
          - Fallback for non-SIMD CPUs
          - Benchmarks showing improvement
        estimate_hours: 10

  - id: phase_5
    name: testing_validation
    priority: P1
    tasks:
      - id: TASK-TEST-001
        title: Property-based tests for VSA invariants
        status: completed
        agent: Tester
        deps: [TASK-VSA-001, TASK-VSA-002, TASK-VSA-003]
        files: [tests/properties.rs, Cargo.toml]
        acceptance:
          - proptest dependency added
          - Bundle commutativity/idempotence tests (bundle is not associative under current semantics)
          - Bind self-inverse tests
          - 1000+ cases passing
        estimate_hours: 8
        completed_at: "2026-01-01"
        
      - id: TASK-TEST-002
        title: Hierarchical encoding E2E tests
        status: pending
        agent: Tester
        deps: [TASK-HIE-004]
        files: [tests/e2e_hierarchical.rs]
        acceptance:
          - TB-scale synthetic dataset generator
          - Multi-level round-trip tests
        estimate_hours: 6
        
      - id: TASK-TEST-003
        title: Resonator convergence tests
        status: pending
        agent: Tester
        deps: [TASK-RES-003]
        files: [tests/resonator_tests.rs]
        acceptance:
          - Deep hierarchy factorization tests
          - Noise regime validation
        estimate_hours: 4

  - id: phase_6
    name: fuse_prototype
    priority: P2
    tasks:
      - id: TASK-FUSE-001
        title: Implement fuser Filesystem trait
        status: completed
        agent: RustEngineer
        deps: [TASK-HIE-004, TASK-RES-003, TASK-TERNARY-001]
        files: [src/fuse_shim.rs, Cargo.toml]
        acceptance:
          - Basic read ops via unbind/cleanup
          - POSIX parity in Docker
        estimate_hours: 16
        completed_at: "2026-01-01"
        notes:
          - "fuser is integrated as an optional dependency behind the fuse feature; EngramFS implements fuser::Filesystem in src/fuse_shim.rs."
          - "Validation: cargo test --features fuse passes."
          - "Docker-level POSIX parity not yet recorded here; recommend QA run via Docker/host mount smoke test."

  - id: phase_7
    name: balanced_ternary_substrate
    priority: P0
    tasks:
      - id: TASK-TERNARY-001
        title: Implement balanced ternary computing substrate
        status: completed
        agent: RustEngineer
        deps: [TASK-VSA-001]
        files: [src/ternary.rs, src/codebook.rs, src/dimensional.rs, src/correction.rs]
        acceptance:
          - Trit/Tryte3/Word6 primitives
          - 38 trits in 61 bits encoding
          - All algebraic properties proven
          - 29 exhaustive tests passing
        estimate_hours: 24
        completed_at: "2025-12-31"
        
      - id: TASK-TERNARY-002
        title: CorrectionStore integration with EmbrFS
        status: completed
        agent: RustEngineer
        deps: [TASK-TERNARY-001]
        files: [src/embrfs.rs, src/correction.rs, tests/reconstruction_guarantee.rs]
        acceptance:
          - 100% bitwise reconstruction guarantee
          - 7 reconstruction tests passing
          - Path-based shift bug fixed
        estimate_hours: 8
        completed_at: "2025-12-31"

  - id: phase_8
    name: fuse_filesystem_integration
    priority: P0
    tasks:
      - id: TASK-FUSE-001
        title: Complete fuser crate integration
        status: completed
        agent: RustEngineer
        deps: [TASK-TERNARY-002]
        files: [src/fuse_shim.rs, src/cli.rs, Cargo.toml]
        acceptance:
          - fuser::Filesystem trait implemented for EngramFS
          - mount/spawn_mount functions with MountOptions
          - CLI mount subcommand with --allow-other, --foreground, --verbose
          - Feature-gated with cfg(feature = "fuse")
          - All 157 tests passing
        estimate_hours: 8
        completed_at: "2025-12-31"

  - id: phase_9
    name: ci_infrastructure
    priority: P0
    tasks:
      - id: TASK-CI-001
        title: ARM64 runner deployment and validation
        status: completed
        agent: DockerDevOps
        deps: []
        files: [.github/workflows/ci-arm64.yml]
        acceptance:
          - Runner registered in GitHub
          - All 33 tests pass on ARM64
        estimate_hours: 12
        
      - id: TASK-CI-002
        title: Enable ARM64 auto-trigger on main
        status: completed
        agent: DockerDevOps
        deps: [TASK-CI-001]
        files: [.github/workflows/ci-arm64.yml]
        acceptance:
          - push trigger enabled
          - First auto-run succeeds
        estimate_hours: 2

summary:
  total_tasks: 33
  completed_tasks: 16
  phases: 11
  critical_path: [TASK-VSA-001, TASK-TERNARY-001, TASK-TERNARY-002, TASK-FUSE-001]
  estimated_total_hours: 180
  last_updated: "2026-01-01T00:00:00Z"
  recent_completions:
    - TASK-BT-001
    - TASK-RET-001
    - TASK-PERF-004
    - TASK-PERF-003
    - TASK-TERNARY-001
    - TASK-TERNARY-002
    - TASK-FUSE-001

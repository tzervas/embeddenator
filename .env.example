# GitHub Actions Runner Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# GitHub Repository Configuration
# ============================================================================

# GitHub repository (format: owner/repo)
GITHUB_REPOSITORY=tzervas/embeddenator

# GitHub API URL (default: https://api.github.com)
GITHUB_API_URL=https://api.github.com

# GitHub Personal Access Token (PAT) with repo scope
# Used for obtaining runner registration tokens
# Generate at: https://github.com/settings/tokens
GITHUB_TOKEN=

# ============================================================================
# Runner Registration Configuration
# ============================================================================

# Runner name prefix (will be suffixed with unique ID or index)
RUNNER_NAME_PREFIX=embeddenator-runner

# Runner labels (comma-separated, default: self-hosted,linux,ARM64)
RUNNER_LABELS=self-hosted,linux,ARM64

# Runner group (default: Default)
RUNNER_GROUP=Default

# Runner work directory (default: _work)
RUNNER_WORK_DIR=_work

# ============================================================================
# Lifecycle Management Configuration
# ============================================================================

# Deployment mode: auto | manual
# - auto: Automatically deregister after idle timeout
# - manual: Keep running until manually stopped
RUNNER_MODE=auto

# Auto-deregister idle timeout in seconds (default: 300 = 5 minutes)
# Only used when RUNNER_MODE=auto
# Runner will deregister if no jobs are in queue for this duration
RUNNER_IDLE_TIMEOUT=300

# Job check interval in seconds (default: 30)
# How often to check for jobs in queue when monitoring
RUNNER_CHECK_INTERVAL=30

# Maximum runner lifetime in seconds (default: 0 = unlimited)
# Runner will deregister after this time regardless of activity
# Set to 0 to disable
RUNNER_MAX_LIFETIME=0

# ============================================================================
# Multi-Runner Deployment Configuration
# ============================================================================

# Number of runners to deploy (default: 1)
RUNNER_COUNT=1

# Runner deployment strategy: sequential | parallel
# - sequential: Deploy runners one at a time
# - parallel: Deploy all runners simultaneously
RUNNER_DEPLOYMENT_STRATEGY=sequential

# Stagger delay between runner deployments in seconds (default: 5)
# Only used when RUNNER_DEPLOYMENT_STRATEGY=sequential
RUNNER_DEPLOYMENT_STAGGER=5

# ============================================================================
# Resource Configuration
# ============================================================================

# CPU cores per runner (default: auto-detect)
# Set to limit CPU usage per runner
RUNNER_CPU_CORES=

# Memory limit per runner in GB (default: none)
# Requires systemd or cgroup support
RUNNER_MEMORY_GB=

# Disk space threshold in GB (default: 20)
# Warning will be issued if free space falls below this
RUNNER_DISK_THRESHOLD_GB=20

# ============================================================================
# Runner Installation Configuration
# ============================================================================

# Runner installation directory (default: ./actions-runner)
RUNNER_INSTALL_DIR=./actions-runner

# Runner version (default: latest)
# Specify a version like "2.319.0" or "latest"
RUNNER_VERSION=latest

# Fallback runner version (default: 2.319.0)
# Used if latest version check fails
RUNNER_FALLBACK_VERSION=2.319.0

# Runner architecture (default: auto-detect)
# Options: x64, arm64
RUNNER_ARCH=

# ============================================================================
# Timeout Configuration
# ============================================================================

# GitHub API timeout in seconds (default: 30)
# Timeout for GitHub API requests (registration, removal tokens, etc.)
GITHUB_API_TIMEOUT=30

# Version check timeout in seconds (default: 10)
# Timeout for checking latest runner version from GitHub
GITHUB_VERSION_CHECK_TIMEOUT=10

# ============================================================================
# Logging and Monitoring Configuration
# ============================================================================

# Log level: DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_LEVEL=INFO

# Log file path (default: ./runner_manager.log)
LOG_FILE=./runner_manager.log

# Enable metrics collection (true | false)
ENABLE_METRICS=false

# Metrics output file (default: ./runner_metrics.json)
METRICS_FILE=./runner_metrics.json

# ============================================================================
# Advanced Configuration
# ============================================================================

# Enable ephemeral runners (true | false)
# Ephemeral runners automatically deregister after completing one job
RUNNER_EPHEMERAL=false

# Replace existing runner with same name (true | false)
RUNNER_REPLACE_EXISTING=false

# Disable automatic updates (true | false)
RUNNER_DISABLE_AUTO_UPDATE=false

# Additional runner configuration flags (space-separated)
# Example: --no-default-labels --disableupdate
RUNNER_ADDITIONAL_FLAGS=

# ============================================================================
# Cleanup Configuration
# ============================================================================

# Clean runner installation on deregister (true | false)
RUNNER_CLEAN_ON_DEREGISTER=true

# Clean Docker resources on deregister (true | false)
RUNNER_CLEAN_DOCKER=true

# Docker cleanup threshold in GB (default: 10)
# Cleanup will run if available space falls below this
DOCKER_CLEANUP_THRESHOLD_GB=10
